{"version":3,"sources":["index.js","assets/marker.png"],"names":["TagManager","initialize","gtmId","App","state","markers","usersPositionObtained","toiletsFound","rangeSlider","handleChange","bind","refreshComponent","window","navigator","geolocation","getCurrentPosition","position","console","log","coords","latitude","longitude","setState","push","axios","post","lat","long","distance","Number","then","response","data","length","forEach","item","toilet_coordinate","loc","coordinates","catch","error","marker","leafletElement","setTimeout","openPopup","event","this","target","value","idx","toiletIcon","L","Icon","iconUrl","popupAnchor","iconSize","Marker","ref","Popup","icon","onClick","href","rel","toiletRetrievalMessage","toiletStatus","positionStatus","className","id","type","min","max","onChange","step","Map","center","zoom","style","width","height","margin","TileLayer","url","attribution","map","userLocationObtained","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.81bfd376.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport TagManager from 'react-gtm-module';\nimport axios from \"axios\";\nimport \"./index.css\";\nimport toiletMarker from './assets/marker.png';\nimport L from 'leaflet';\nimport { Map, TileLayer, Marker, Popup } from \"react-leaflet\";\n\nconst tagManagerArgs = {\n  gtmId: 'GTM-NM4MJGQ'\n}\n\nTagManager.initialize(tagManagerArgs);\n\n\nclass App extends Component {\n  state = {\n    // 15 Queens Rd\n    //   lat: -37.8390583,\n    //   lng: 144.97499729999998\n    markers: [],\n    usersPositionObtained: \"NO\",\n    toiletsFound: \"NO\",\n\n    // initial value for distance range slider\n    rangeSlider: 500\n  };\n\n  constructor() {\n    super()\n    this.handleChange = this.handleChange.bind(this)\n    this.refreshComponent = this.refreshComponent.bind(this)\n  }\n\n  componentDidMount() {\n    window.navigator.geolocation.getCurrentPosition(position => {\n      console.log(\n        \"Current user's location is \" +\n        position.coords.latitude +\n        \", \" +\n        position.coords.longitude\n      );\n\n      this.setState({ usersPositionObtained: \"YES\" });\n\n      // add to the markers ; i think there's a better way to do this (spread operator ?)\n      const { markers } = this.state;\n      console.log(\"before \", this.state.markers);\n      markers.push([position.coords.latitude, position.coords.longitude]);\n      this.setState({ markers });\n      console.log(\"after\", this.state.markers);\n    \n      axios\n      .post(\"https://loocation-toiletfinder-server.herokuapp.com/api/toilets-dist/\", {\n        lat: position.coords.latitude,\n        long: position.coords.longitude,\n        distance: Number(this.state.rangeSlider)\n      })\n      .then(response => {\n        //   console.log(response);\n        if (\n          typeof response.data.data !== \"undefined\" &&\n          response.data.data.length > 0\n        ) {\n          this.setState({ toiletsFound: \"YES\" });\n          let toilets = response.data.data;\n\n          toilets.forEach(item => {\n            let toilet_coordinate = item.loc;\n\n            markers.push([\n              toilet_coordinate.coordinates[1],\n              toilet_coordinate.coordinates[0]\n            ]);\n            this.setState({ markers });\n\n            console.log(\n              \"FROM POST REQUEST: coordinates lat: \" +\n                toilet_coordinate.coordinates[1] +\n                \" coordinates long: \" +\n                toilet_coordinate.coordinates[0]\n            );\n          });\n        }\n      })\n      .catch(function(error) {\n        console.log(error);\n      });\n    });\n  }\n\n  refreshComponent() {\n    window.navigator.geolocation.getCurrentPosition(position => {\n      console.log(\n        \"Current user's location is \" +\n        position.coords.latitude +\n        \", \" +\n        position.coords.longitude\n      );\n\n      this.setState({ usersPositionObtained: \"YES\" });\n\n      // reset markers because we are refreshing\n      this.setState({ markers: [] });\n      this.setState({toiletsFound: \"NO\"});\n\n      // add to the markers ; i think there's a better way to do this (spread operator ?)\n      const { markers } = this.state;\n      this.setState({markers})\n      markers.push([position.coords.latitude, position.coords.longitude]);\n      \n      \n      this.handleChange = this.handleChange.bind(this)\n    \n      axios\n      .post(\"https://loocation-toiletfinder-server.herokuapp.com/api/toilets-dist/\", {\n        lat: position.coords.latitude,\n        long: position.coords.longitude,\n        distance: Number(this.state.rangeSlider)\n      })\n      .then(response => {\n        //   console.log(response);\n        if (\n          typeof response.data.data !== \"undefined\" &&\n          response.data.data.length > 0\n        ) {\n          this.setState({ toiletsFound: \"YES\" });\n          let toilets = response.data.data;\n\n          toilets.forEach(item => {\n            let toilet_coordinate = item.loc;\n\n            markers.push([\n              toilet_coordinate.coordinates[1],\n              toilet_coordinate.coordinates[0]\n            ]);\n            this.setState({ markers });\n\n            console.log(\n              \"FROM POST REQUEST: coordinates lat: \" +\n                toilet_coordinate.coordinates[1] +\n                \" coordinates long: \" +\n                toilet_coordinate.coordinates[0]\n            );\n          });\n        }\n      })\n      .catch(function(error) {\n        console.log(error);\n      });\n    });\n  }\n\n  openPopup(marker) {\n    if (marker && marker.leafletElement) {\n      window.setTimeout(() => {\n        marker.leafletElement.openPopup();\n      });\n    }\n  }\n\n  handleChange(event) {\n    this.setState({rangeSlider: event.target.value});\n  }\n  \n  userLocationObtained(idx, position) {\n    const toiletIcon = new L.Icon({\n      iconUrl: toiletMarker,\n      popupAnchor:  [-0, -0],\n      iconSize: [32,45],     \n    });\n\n    // open the marker popup only for first marker!\n    if (idx === 0) {\n      return (\n        <Marker key={`marker-${idx}`} position={position} ref={this.openPopup}>\n          <Popup>\n            <span>You are Here !</span>\n          </Popup>\n        </Marker>\n      );\n    } else {\n      return (\n        <Marker\n          key={`marker-${idx}`}\n          icon={toiletIcon}\n          position={position}\n          onClick={this.openPopup}\n        >\n          <Popup>\n            Click&nbsp;\n            <a\n              href={`http://maps.google.com/maps?daddr=${position[0]},${position[1]}&amp;ll=`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              here\n            </a>\n            &nbsp; to navigate to this location\n          </Popup>\n        </Marker>\n      );\n    }\n  }\n\n  render() {\n    const toiletStatus = this.state.toiletsFound;\n    let toiletRetrievalMessage;\n\n    if (toiletStatus === \"NO\" && this.state.usersPositionObtained === \"YES\") {\n      toiletRetrievalMessage = (\n        <p>\n          Sadly, there were no toilets found, this is likely because there are\n          no toilets in the vicinity of {this.state.rangeSlider} meters\n          <i>\n            <br></br>\n            For developers, and those interested, try overriding the GPS sensor\n            to -37.818078, 144.96681\n          </i>\n        </p>\n      );\n    } else if (toiletStatus === \"YES\") {\n      toiletRetrievalMessage = <p>Bust before you rust! Your kidneys will thank you later!</p>;\n    }\n\n    // for setting the position obtained status color\n    let positionStatus = 'red';\n    if (this.state.usersPositionObtained === \"YES\") {\n      positionStatus = 'green';\n    }\n\n    return (\n      \n      <div className=\"map\">\n        <h1 className=\"test\"> LooCation </h1>\n        <p> Note - the current search radius is {this.state.rangeSlider} meters</p>\n        <p> User Position Obtained: <span className={positionStatus}> {this.state.usersPositionObtained} </span> </p>\n        {toiletRetrievalMessage}\n\n        <p> Change Toilet Search Radius : \n          <input \n            id=\"typeinp\" \n            type=\"range\" \n            min=\"100\" max=\"3000\" \n            value={this.state.rangeSlider} \n            onChange={this.handleChange}\n            step=\"100\"/>\n            <button onClick={this.refreshComponent}>Refresh</button>\n        </p>\n\n        <Map\n          center={[-37.808163434, 144.957829502]}\n          zoom={16}\n          style={{ width: \"80%\", height: \"40em\", margin: \"auto\" }}\n        >\n          <TileLayer\n            url=\"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png\"\n            attribution='&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attribution\">CARTO</a>'\n          />\n          {this.state.markers.map((position, idx) =>\n            this.userLocationObtained(idx, position)\n          )}\n        </Map>\n      </div>\n    );\n  }\n}\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","export default \"data:image/png;base64,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\""],"sourceRoot":""}